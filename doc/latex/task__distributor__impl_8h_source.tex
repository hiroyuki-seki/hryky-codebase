\hypertarget{task__distributor__impl_8h_source}{\section{task\-\_\-distributor\-\_\-impl.\-h}
}

\begin{DoxyCode}
00001 
00009 \textcolor{preprocessor}{#ifndef TASK\_DISTRIBUTOR\_IMPL\_H\_20111211163004354}
00010 \textcolor{preprocessor}{}\textcolor{preprocessor}{#define TASK\_DISTRIBUTOR\_IMPL\_H\_20111211163004354}
00011 \textcolor{preprocessor}{}\textcolor{preprocessor}{#include "\hyperlink{task__distributor__base_8h}{hryky/task/task_distributor_base.h}"}
00012 \textcolor{preprocessor}{#include "\hyperlink{vector_8h}{hryky/vector.h}"}
00013 \textcolor{preprocessor}{#include "\hyperlink{foreach_8h}{hryky/foreach.h}"}
00014 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00015 \textcolor{comment}{// macro definition}
00016 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00017 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00018 \textcolor{comment}{// namespace}
00019 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00020 \textcolor{keyword}{namespace }hryky
00021 \{
00022 \textcolor{keyword}{namespace }task
00023 \{
00024 \textcolor{keyword}{namespace }distributor
00025 \{
00027     \textcolor{keyword}{template} < \textcolor{keyword}{typename} WorkerT >
00028     \textcolor{keyword}{class }Impl;
00029 \}
00030 \}
00031 \}
00032 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00033 \textcolor{comment}{// class declaration}
00034 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00038 \textcolor{comment}{}\textcolor{keyword}{template} <\textcolor{keyword}{typename} WorkerT >
\hypertarget{task__distributor__impl_8h_source_l00039}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{00039} \textcolor{keyword}{class }\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{hryky::task::distributor::Impl} : \textcolor{keyword}{public} \hyperlink{classhryky_1_1task_1_1distributor_1_1_base}{hryky::task::distributor::Base}
00040 \{
00041 \textcolor{keyword}{public} :
00042 
\hypertarget{task__distributor__impl_8h_source_l00043}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a800b2a9aab8caca81adadd22b8be0648}{00043}     \textcolor{keyword}{typedef} \hyperlink{classhryky_1_1task_1_1distributor_1_1_base}{Base}                        \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a800b2a9aab8caca81adadd22b8be0648}{base_type};
\hypertarget{task__distributor__impl_8h_source_l00044}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a931909e94f135cdf82ab3c24ffe2915f}{00044}     \textcolor{keyword}{typedef} \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{Impl<WorkerT>}               \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a931909e94f135cdf82ab3c24ffe2915f}{this_type};
\hypertarget{task__distributor__impl_8h_source_l00045}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_aac4725b3a2aa443edf1eb607b73ba2be}{00045}     \textcolor{keyword}{typedef} WorkerT                     \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_aac4725b3a2aa443edf1eb607b73ba2be}{worker_type};
00046     \textcolor{keyword}{typedef} \hyperlink{classhryky_1_1_vector}{Vector<worker_type>}         \hyperlink{classhryky_1_1_vector}{workers_type};
00047     
00049     \hyperlink{classhryky_1_1_intrusive_ptr}{reduction_type} \hyperlink{group__task_ga0170ebe627b3f2a67912e5b237994b9d}{reduce}(\hyperlink{classhryky_1_1reduction_1_1_string}{reduction::name_type} \textcolor{keyword}{const} & name) \textcolor{keyword}{const};
00050 
00051 \textcolor{keyword}{protected} :
00052 
00054     \hyperlink{group__task_gaa414ac5e76735f881871f98e288003e0}{Impl}();
00055 
00057     \textcolor{keyword}{virtual} \hyperlink{group__task_gae688f82c064cc006f0eba491339faca1}{~Impl}();
00058 
\hypertarget{task__distributor__impl_8h_source_l00060}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_ada35bdee49d5012cd0bc8bd398278afd}{00060}     \hyperlink{classhryky_1_1task_1_1worker_1_1_base}{worker_type} & \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_ada35bdee49d5012cd0bc8bd398278afd}{worker}(\textcolor{keywordtype}{size\_t} index) \{ \textcolor{keywordflow}{return} this->workers\_[index]; \}
00061 
\hypertarget{task__distributor__impl_8h_source_l00063}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a8b3195bf033c49aba3471b44744951e0}{00063}     \hyperlink{classhryky_1_1task_1_1worker_1_1_base}{worker_type} \textcolor{keyword}{const} & \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a8b3195bf033c49aba3471b44744951e0}{worker}(\textcolor{keywordtype}{size\_t} index)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this->workers\_[
      index]; \}
00064 
\hypertarget{task__distributor__impl_8h_source_l00066}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a99b4191fe1abb7aa61d4083b0a79bfc0}{00066}     \textcolor{keyword}{typename} \hyperlink{classhryky_1_1iterator_1_1random_1_1_mutable}{workers_type::iterator} \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a99b4191fe1abb7aa61d4083b0a79bfc0}{workers_begin}() \{ \textcolor{keywordflow}{return} this->workers\_.
      \hyperlink{classhryky_1_1_vector_aa032aa9e48dce836e68434e6ad58f0f5}{begin}(); \}
00067 
\hypertarget{task__distributor__impl_8h_source_l00069}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a981400fa1d60ebf567b70c7f3bea7651}{00069}     \textcolor{keyword}{typename} \hyperlink{classhryky_1_1iterator_1_1random_1_1_immutable}{workers_type::const_iterator} \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a981400fa1d60ebf567b70c7f3bea7651}{workers_begin}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this->
      workers\_.\hyperlink{classhryky_1_1_vector_aa032aa9e48dce836e68434e6ad58f0f5}{begin}(); \}
00070 
\hypertarget{task__distributor__impl_8h_source_l00072}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a3b14236e27e27190e7f9f90469d6f3bf}{00072}     \textcolor{keyword}{typename} \hyperlink{classhryky_1_1iterator_1_1random_1_1_mutable}{workers_type::iterator} \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_a3b14236e27e27190e7f9f90469d6f3bf}{workers_end}() \{ \textcolor{keywordflow}{return} this->workers\_.\hyperlink{classhryky_1_1_vector_ae17851e0d811d052645dd6e5a507f365}{end}()
      ; \}
00073 
\hypertarget{task__distributor__impl_8h_source_l00075}{}\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_aba1ffce9125b4c8ac4de7a4551aad8df}{00075}     \textcolor{keyword}{typename} \hyperlink{classhryky_1_1iterator_1_1random_1_1_immutable}{workers_type::const_iterator} \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl_aba1ffce9125b4c8ac4de7a4551aad8df}{workers_end}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this->
      workers\_.\hyperlink{classhryky_1_1_vector_ae17851e0d811d052645dd6e5a507f365}{end}(); \}
00076 
00078     \textcolor{keywordtype}{void} \hyperlink{group__task_gaf3c6d1475b000e7f2cf6b7448fc2dfdc}{implement}(workers\_type & workers);
00079 
00080 \textcolor{keyword}{private} :
00081 
00083     \textcolor{keyword}{explicit} \hyperlink{group__task_gaa414ac5e76735f881871f98e288003e0}{Impl}(\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{Impl} \textcolor{keyword}{const} &);
00084 
00086     \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{Impl} & operator=(\hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{Impl} \textcolor{keyword}{const} &rhs);
00087 
00089     \textcolor{keywordtype}{void} clear();
00090 
00091     workers\_type    workers\_;
00092 \};
00093 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00094 \textcolor{comment}{// public member functions}
00095 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00099 \textcolor{comment}{}\textcolor{keyword}{template} < \textcolor{keyword}{typename} WorkerT >
00100 \hyperlink{classhryky_1_1_intrusive_ptr}{hryky::reduction_type}
\hypertarget{task__distributor__impl_8h_source_l00101}{}\hyperlink{group__task_ga0170ebe627b3f2a67912e5b237994b9d}{00101} \hyperlink{group__task_ga0170ebe627b3f2a67912e5b237994b9d}{hryky::task::distributor::Impl<WorkerT>::reduce}(
00102     \hyperlink{classhryky_1_1reduction_1_1_string}{reduction::name_type} \textcolor{keyword}{const} & name)\textcolor{keyword}{ const}
00103 \textcolor{keyword}{}\{
00104     \hyperlink{classhryky_1_1_intrusive_ptr}{reduction::map_type} \hyperlink{namespacehryky_1_1reduction_ac5eae270cf8047b294dc4ff3e5e11a79}{map} = \hyperlink{namespacehryky_1_1reduction_ac5eae270cf8047b294dc4ff3e5e11a79}{reduction::map}(name);
00105 
00106     map->append(\textcolor{stringliteral}{"workers\_size"}, this->workers\_size());
00107 
00108     \hyperlink{classhryky_1_1_intrusive_ptr}{reduction::array_type} workers = \hyperlink{namespacehryky_1_1reduction_a9d45a4dc1ea9a6668ebd192f296f788c}{reduction::array}(\textcolor{stringliteral}{"workers"});
00109     \hyperlink{classhryky_1_1_foreach}{Foreach<workers_type const>} \textcolor{keywordflow}{foreach}(this->workers\_);
00110     \textcolor{keywordflow}{for} (; \textcolor{keywordflow}{foreach}.valid(); ++\textcolor{keywordflow}{foreach}) \{
00111         workers->append(*\textcolor{keywordflow}{foreach});
00112     \}
00113 
00114     map->append(workers);
00115 
00116     \textcolor{keywordflow}{return} \hyperlink{namespacehryky_1_1reduction_ac5eae270cf8047b294dc4ff3e5e11a79}{map};
00117 \}
00118 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00119 \textcolor{comment}{// protected member functions}
00120 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00124 \textcolor{comment}{}\textcolor{keyword}{template} <\textcolor{keyword}{typename} WorkerT>
\hypertarget{task__distributor__impl_8h_source_l00125}{}\hyperlink{group__task_gaa414ac5e76735f881871f98e288003e0}{00125} \hyperlink{group__task_gaa414ac5e76735f881871f98e288003e0}{hryky::task::distributor::Impl<WorkerT>::Impl}()
00126     : \hyperlink{classhryky_1_1task_1_1distributor_1_1_base}{base_type}()
00127       , workers\_()
00128 \{
00129     \textcolor{keywordflow}{return};
00130 \}
00134 \textcolor{keyword}{template} <\textcolor{keyword}{typename} WorkerT>
\hypertarget{task__distributor__impl_8h_source_l00135}{}\hyperlink{group__task_gae688f82c064cc006f0eba491339faca1}{00135} \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{hryky::task::distributor::Impl<WorkerT>::~Impl}()
00136 \{
00137     this->join();
00138 \}
00142 \textcolor{keyword}{template} <\textcolor{keyword}{typename} WorkerT>
\hypertarget{task__distributor__impl_8h_source_l00143}{}\hyperlink{group__task_gaf3c6d1475b000e7f2cf6b7448fc2dfdc}{00143} \textcolor{keywordtype}{void} \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{hryky::task::distributor::Impl<WorkerT>::implement}(\hyperlink{classhryky_1_1_vector}{workers_type} & workers)
00144 \{
00145     this->workers\_.swap(workers);
00146 
00147     \hyperlink{classhryky_1_1_foreach}{Foreach<workers_type>} \textcolor{keywordflow}{foreach}(this->workers\_);
00148     \textcolor{keywordflow}{for} (; \textcolor{keywordflow}{foreach}.valid(); ++\textcolor{keywordflow}{foreach}) \{
00149         \hyperlink{classhryky_1_1task_1_1worker_1_1_base}{worker_type} & worker = *\textcolor{keywordflow}{foreach};
00150         workers\_type::size\_type \textcolor{keyword}{const} index = &worker - &*this->workers\_.begin(
      );
00151         
00152         this->base\_type::implement(worker, index);
00153     \}
00154 \}
00155 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00156 \textcolor{comment}{// private member functions}
00157 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00161 \textcolor{comment}{}\textcolor{keyword}{template} <\textcolor{keyword}{typename} WorkerT>
00162 \textcolor{keywordtype}{void} \hyperlink{namespacehryky_aa201297ea9530da954a7230be71cc19d}{hryky::task::distributor::Impl<WorkerT>::clear}()
00163 \{
00164     this->workers\_.reset(\hyperlink{common_8h_a4cd4ac09cfcdbd6b30ee69afc156e210}{HRYKY_NULLPTR});
00165 \}
00166 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00167 \textcolor{comment}{// inline functions}
00168 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00169 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00170 \textcolor{comment}{// function prototypes}
00171 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00172 \textcolor{keyword}{namespace }hryky
00173 \{
00174 \textcolor{keyword}{namespace }task
00175 \{
00176 \textcolor{keyword}{namespace }distributor
00177 \{
00179     \textcolor{keyword}{template} < \textcolor{keyword}{typename} WorkerT >
00180     \hyperlink{classhryky_1_1_intrusive_ptr}{reduction_type} \hyperlink{group__task_ga89a7a92c43485c438438ab4b97184a27}{reduce}(
00181         \hyperlink{classhryky_1_1reduction_1_1_string}{reduction::name_type} \textcolor{keyword}{const} & name, Impl<WorkerT> \textcolor{keyword}{const} & impl);
00182 
00183 \}
00184 \}
00185 \}
00186 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00187 \textcolor{comment}{// global functions}
00188 \textcolor{comment}{//
      ------------------------------------------------------------------------------}
00192 \textcolor{comment}{}\textcolor{keyword}{template} < \textcolor{keyword}{typename} WorkerT >
\hypertarget{task__distributor__impl_8h_source_l00193}{}\hyperlink{group__task_gaee44063e86225742b935c19f76d7d7c4}{00193} \hyperlink{classhryky_1_1_intrusive_ptr}{hryky::reduction_type} \hyperlink{group__task_ga89a7a92c43485c438438ab4b97184a27}{hryky::task::distributor::reduce}(
00194     \hyperlink{classhryky_1_1reduction_1_1_string}{reduction::name_type} \textcolor{keyword}{const} & name, \hyperlink{classhryky_1_1task_1_1distributor_1_1_impl}{Impl<WorkerT>} \textcolor{keyword}{const} & impl)
00195 \{
00196     \textcolor{keywordflow}{return} impl.\hyperlink{group__task_ga0170ebe627b3f2a67912e5b237994b9d}{reduce}(name);
00197 \}
00198 \textcolor{preprocessor}{#endif // TASK\_DISTRIBUTOR\_IMPL\_H\_20111211163005354}
00199 \textcolor{preprocessor}{}
00200 \textcolor{comment}{// end of file}
\end{DoxyCode}
